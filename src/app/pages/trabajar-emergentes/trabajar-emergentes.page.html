<ion-header *ngIf="viewEntered" class="animate__animated animate__fadeIn">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="back()" color="light">Atrás
        <ion-icon slot="start" name="arrow-back-outline" color="light"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Trabajar vehículo</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content *ngIf="viewEntered" class="animate__animated animate__fadeIn">
<br>
  <!-- 1 Sin aperturar -->
  <div *ngIf="sinIniciar">
    <ion-button expand="block" color="success" (click)="iniciarTrabajo()">Iniciar trabajo</ion-button>
  </div>

  <ion-accordion-group>
    <ion-accordion value="first" [disabled]="disabled || sinIniciar">
      <ion-item slot="header" color="light">
        <ion-label>Checklist del vehículo</ion-label>
      </ion-item>
      <div class="ion-padding" slot="content">
        <ion-input type="text" placeholder="Entrega vehículo..." [(ngModel)]="recibe"></ion-input>
        <ion-button expand="block" color="dark" (click)="mostrarModalLuces()">Iniciar checklist</ion-button>
      </div>
    </ion-accordion>
    <ion-accordion value="second" [disabled]="sinIniciar">
      <ion-item slot="header" color="light">
        <ion-label>Fotografías del vehículo</ion-label>
      </ion-item>
      <div class="ion-padding" slot="content">
        <ion-card class="ion-card-slide" *ngFor="let item of titulosImagenes; index as i" (click)="presentActionSheet(i)">
            <ion-card-header>
              <ion-card-title style="font-size: 22px;">{{item.nombre}}</ion-card-title>
              <ion-row>
                <ion-col size="12" class="center" *ngIf="!mostrarFoto[i]">
                  <p style="color: rgb(167, 165, 165); margin-top: 8px;">
                    <ion-icon name="arrow-down-outline" style="zoom:0.9;" class="ion-icon" slot="start"></ion-icon>
                      Pulsa para agregar una foto
                    <ion-icon name="arrow-down-outline" style="zoom:0.9;" class="ion-icon" slot="end"></ion-icon>
                  </p>
                </ion-col>
              </ion-row>
            </ion-card-header>
            <ion-card-content style="margin-top: -46px;">
              <div *ngIf="mostrarFoto[i]">
                  <img [src]="fotos[i]" class="imageDefault">
              </div>
              <div *ngIf="!mostrarFoto[i]">
                <img src="../../../assets/img/imagePhoto.jpg" style="    max-width: 100%;
                border-radius: 12px;
                margin-top: 15px;">
              </div>
            </ion-card-content>
        </ion-card>
      </div>
    </ion-accordion>
  </ion-accordion-group>




  <ion-card>
    <ion-card-content>
      <ion-row>
        <ion-col size="2">
          <ion-label>
            <ion-icon name="car" style="zoom:3;" class="ion-icon" slot="start"></ion-icon>
          </ion-label>
        </ion-col>
        <ion-col size="10">
          <ion-label class="alignright">
            <ion-note style="font-size: 22px;">&nbsp;Datos generales&nbsp;</ion-note>
          </ion-label>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="2.6">
          <ion-badge class="badge">Placa :</ion-badge>
        </ion-col>
        <ion-col size="7.4">
          <ion-text *ngIf="vehiculo.placa !== '' || vehiculo.placa !== null">
            <h6>{{vehiculo.placa}}</h6>
          </ion-text>
          <ion-text *ngIf="vehiculo.placa === '' || vehiculo.placa === null">
            <h6>No especificado</h6>
          </ion-text>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="1.6">
          <ion-badge class="badge">ID :</ion-badge>
        </ion-col>
        <ion-col size="10.4">
          <ion-text *ngIf="vehiculo.ID !== '' || vehiculo.ID !== null">
            <h6>{{vehiculo.ID}}</h6>
          </ion-text>
          <ion-text *ngIf="vehiculo.ID === '' || vehiculo.ID === null">
            <h6>No especificado</h6>
          </ion-text>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="5.2">
          <ion-badge class="badge">Tipo de vehículo :</ion-badge>
        </ion-col>
        <ion-col size="6.8">
          <ion-text *ngIf="vehiculo.nombre !== '' || vehiculo.nombre !== null">
            <h6>{{vehiculo.nombre}}</h6>
          </ion-text>
          <ion-text *ngIf="vehiculo.nombre === '' || vehiculo.nombre === null">
            <h6>No especificado</h6>
          </ion-text>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="2.6">
          <ion-badge class="badge">Marca :</ion-badge>
        </ion-col>
        <ion-col size="9.4">
          <ion-text *ngIf="vehiculo.marca !== '' || vehiculo.marca !== null">
            <h6>{{vehiculo.marca}}</h6>
          </ion-text>
          <ion-text *ngIf="vehiculo.marca === '' || vehiculo.marca === null">
            <h6>No especificado</h6>
          </ion-text>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="2.6">
          <ion-badge class="badge">Color :</ion-badge>
        </ion-col>
        <ion-col size="9.4">
          <ion-text *ngIf="vehiculo.color !== '' || vehiculo.color !== null">
            <h6>{{vehiculo.color}}</h6>
          </ion-text>
          <ion-text *ngIf="vehiculo.color === '' || vehiculo.color === null">
            <h6>No especificado</h6>
          </ion-text>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="2.9">
          <ion-badge class="badge">Franjas :</ion-badge>
        </ion-col>
        <ion-col size="9.1">
          <ion-text *ngIf="vehiculo.franjas !== '' || vehiculo.franjas !== null">
            <h6>{{vehiculo.franjas}}</h6>
          </ion-text>
          <ion-text *ngIf="vehiculo.franjas === '' || vehiculo.franjas === null">
            <h6>No especificado</h6>
          </ion-text>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="2.6">
          <ion-badge class="badge">Línea :</ion-badge>
        </ion-col>
        <ion-col size="9.4">
          <ion-text *ngIf="vehiculo.linea !== '' || vehiculo.linea !== null">
            <h6>{{vehiculo.linea}}</h6>
          </ion-text>
          <ion-text *ngIf="vehiculo.linea === '' || vehiculo.linea === null">
            <h6>No especificado</h6>
          </ion-text>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="2.9">
          <ion-badge class="badge">Modelo :</ion-badge>
        </ion-col>
        <ion-col size="9.1">
          <ion-text *ngIf="vehiculo.modelo !== '' || vehiculo.modelo !== null">
            <h6>{{vehiculo.modelo}}</h6>
          </ion-text>
          <ion-text *ngIf="vehiculo.modelo === '' || vehiculo.modelo === null">
            <h6>No especificado</h6>
          </ion-text>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="4.5">
          <ion-badge class="badge">Observaciones :</ion-badge>
        </ion-col>
        <ion-col size="7.5">
          <ion-text *ngIf="vehiculo.observaciones !== '' || vehiculo.observaciones !== null">
            <h6>{{vehiculo.observaciones}}</h6>
          </ion-text>
          <ion-text *ngIf="vehiculo.observaciones === '' || vehiculo.observaciones === null">
            <h6>No especificado</h6>
          </ion-text>
        </ion-col>
      </ion-row>
    </ion-card-content>
  </ion-card>

  <ion-list-header style="margin-bottom: -5px;">
    Equipos Instalados
  </ion-list-header>

  <div style="text-align: center;" *ngIf="spinner">
    <br>
    <br>
    <ion-spinner style="zoom: 1.5;"></ion-spinner>
  </div>
  <ion-card>
    <ion-row style="margin-top: 15px; margin-bottom: 20px;" *ngIf="equiposInstalados.length !== 0 && equiposInstalados !== null  && !spinner">
      <ion-label style="margin-left: 46%;">
        <ion-icon name="arrow-back-outline" style="zoom:0.9;" slot="start" style="color: gray; margin-bottom: -4px;"></ion-icon>
        <ion-text style="color: gray; font-size: 14px;">&nbsp;Desliza para ver opciones&nbsp;&nbsp;</ion-text>
      </ion-label>
    </ion-row>
    <ion-list *ngIf="equiposInstalados.length !== 0 && equiposInstalados !== null && !spinner" style="margin-bottom: -17px;">
      <ion-item-sliding *ngFor="let equipo of equiposInstalados" class="animate__animated animate__bounceInLeft">
        <ion-item style="margin-bottom: 1px;">
          <ion-label>
            <h2>Modelo: {{ equipo.modelo }}</h2>
            <h3>Serie {{ equipo.serie }} </h3>
            <h3>IMEI: {{ equipo.imei }}</h3>
            <h3 style="color: lightslategrey;">SIM: {{ equipo.sim_nombre}}</h3>
          </ion-label>
        </ion-item>
      <ion-item-options side="end">
        <ion-item-option color="tertiary" expandable (click)="desintalacionSIMActionSheet(equipo)">
          <ion-icon slot="icon-only" name="exit-outline"></ion-icon>
        </ion-item-option>
        <ion-item-option color="danger" expandable (click)="desintalacionEquipoActionSheet(equipo)">
          <ion-icon slot="icon-only" name="exit"></ion-icon>
        </ion-item-option>
      </ion-item-options>
    </ion-item-sliding>
    <br>
    </ion-list>
  </ion-card>

  <ion-card *ngIf="(equiposInstalados.length === 0 || equiposInstalados === null) && !spinner" class="animate__animated animate__bounceInLeft">
    <ion-card-header>
      <ion-card-subtitle class="ion-text-center">No hay equipos para seleccionar!</ion-card-subtitle>
    </ion-card-header>
  </ion-card>


    <ion-list-header style="margin-bottom: -5px;">
      Equipos por instalar
    </ion-list-header>

    <div style="text-align: center;" *ngIf="spinner">
      <br>
      <br>
      <ion-spinner style="zoom: 1.5;"></ion-spinner>
    </div>
    <ion-card>
      <ion-row style="margin-top: 15px; margin-bottom: 20px;" *ngIf="equiposASeleccionar.length !== 0 && equiposASeleccionar !== null && !spinner">
        <ion-label style="margin-left: 55%;">
          <ion-icon name="arrow-back-outline" style="zoom:0.9;" slot="start" style="color: gray; margin-bottom: -4px;"></ion-icon>
          <ion-text style="color: gray; font-size: 14px;">&nbsp;Desliza para asignar&nbsp;&nbsp;</ion-text>
        </ion-label>
      </ion-row>
      <ion-list *ngIf="equiposASeleccionar.length !== 0 && equiposASeleccionar !== null  && !spinner" style="margin-bottom: -17px;">
        <ion-item-sliding *ngFor="let equipo of equiposASeleccionar" class="animate__animated animate__bounceInLeft">
          <ion-item style="margin-bottom: 1px;">
            <ion-label>
              <h2>Modelo: {{ equipo.modelo }}</h2>
              <h3>Serie {{ equipo.serie }} </h3>
              <h3>IMEI: {{ equipo.imei }}</h3>
              <h3 style="color: lightslategrey;">SIM: {{ equipo.sim_nombre}}</h3>
            </ion-label>
          </ion-item>
        <ion-item-options side="end">
          <ion-item-option color="tertiary" expandable (click)="seleccionar(equipo)">
            <ion-icon slot="icon-only" name="arrow-forward-circle-outline"></ion-icon>
          </ion-item-option>
        </ion-item-options>
      </ion-item-sliding>
      <br>
      </ion-list>
    </ion-card>

    <ion-card *ngIf="(equiposASeleccionar.length === 0 || equiposASeleccionar === null) && !spinner" class="animate__animated animate__bounceInLeft">
      <ion-card-header>
        <ion-card-subtitle class="ion-text-center">No hay equipos para seleccionar!</ion-card-subtitle>
      </ion-card-header>
    </ion-card>




    <ion-list-header style="margin-bottom: -5px;">
      SIM's por instalar
    </ion-list-header>

    <div style="text-align: center;" *ngIf="spinner">
      <br>
      <br>
      <ion-spinner style="zoom: 1.5;"></ion-spinner>
    </div>
    <ion-card>
      <ion-row style="margin-top: 15px; margin-bottom: 20px;" *ngIf="simsASeleccionar.length !== 0 && simsASeleccionar !== null && !spinner">
        <ion-label style="margin-left: 55%;">
          <ion-icon name="arrow-back-outline" style="zoom:0.9;" slot="start" style="color: gray; margin-bottom: -4px;"></ion-icon>
          <ion-text style="color: gray; font-size: 14px;">&nbsp;Desliza para asignar&nbsp;&nbsp;</ion-text>
        </ion-label>
      </ion-row>
      <ion-list *ngIf="simsASeleccionar.length !== 0 && simsASeleccionar !== null && !spinner" style="margin-bottom: -17px;">
        <ion-item-sliding *ngFor="let sim of simsASeleccionar" class="animate__animated animate__bounceInLeft">
          <ion-item style="margin-bottom: 1px;">
            <ion-label>
              <h2>Telefono: {{ sim.linea }} </h2>
              <h3>Telefonía: {{ sim.telefonia }} </h3>
              <h3>IP: {{ sim.ip }}</h3>
            </ion-label>
          </ion-item>
        <ion-item-options side="end">
          <ion-item-option color="tertiary" expandable (click)="seleccionarSim(sim)">
            <ion-icon slot="icon-only" name="arrow-forward-circle-outline"></ion-icon>
          </ion-item-option>
        </ion-item-options>
      </ion-item-sliding>
      <br>
      </ion-list>
    </ion-card>

    <ion-card *ngIf="(simsASeleccionar.length === 0 || simsASeleccionar === null) && !spinner" class="animate__animated animate__bounceInLeft" >
      <ion-card-header>
        <ion-card-subtitle class="ion-text-center">No hay sim's para seleccionar!</ion-card-subtitle>
      </ion-card-header>
    </ion-card>


  <ion-accordion-group>
    <ion-accordion value="second">
      <ion-item slot="header" color="light">
        <ion-label>Firma y responsable</ion-label>
      </ion-item>
      <div class="ion-padding" slot="content">
        <ion-card class="ion-card-slide ion-activatable" style="padding-bottom: 6%; padding-top: 1%;" (click)="mostrarModalSign()">
          <ion-row>
            <ion-col size="12" class="center">
              <p style="color: rgb(167, 165, 165); margin-top: 8px;">
                <ion-icon name="arrow-down-outline" style="zoom:0.9;" class="ion-icon" slot="start"></ion-icon>
                  Pulsa para agregar firma
                <ion-icon name="arrow-down-outline" style="zoom:0.9;" class="ion-icon" slot="end"></ion-icon>
              </p>
            </ion-col>
          </ion-row>
          <img src="../../../assets/img/imageSign.jpg" class="imageDefault" *ngIf="!mostrarFirma">
          <img [src]="signature" class="imageDefault" *ngIf="mostrarFirma">
          <ion-ripple-effect></ion-ripple-effect>
        </ion-card>
      </div>
    </ion-accordion>
  </ion-accordion-group>
<br>
  <div *ngIf="canceladaFallidaCompletada">
    <ion-button expand="block" color="success" (click)="finalizarTrabajo()"><b>Finalizar trabajo</b></ion-button>
  </div>
<br>


</ion-content>
